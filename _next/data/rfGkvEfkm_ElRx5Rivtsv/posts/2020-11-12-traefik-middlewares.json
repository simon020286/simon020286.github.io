{"pageProps":{"source":{"compiledSource":"var l=Object.defineProperty,u=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var c=(a,n,t)=>n in a?l(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=>{for(var t in n||(n={}))o.call(n,t)&&c(a,t,n[t]);if(p)for(var t of p(n))r.call(n,t)&&c(a,t,n[t]);return a},i=(a,n)=>u(a,N(n));var m=(a,n)=>{var t={};for(var s in a)o.call(a,s)&&n.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&p)for(var s of p(a))n.indexOf(s)<0&&r.call(a,s)&&(t[s]=a[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,i(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"Buongiorno a tutti,\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"oggi vedremo come creare i primi e pi\\xF9 semplici middlewares per Traefik.\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"Cosa \\xE8 un middleware?\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"Semplificando molto \\xE8 qualcosa che si frappone tra la chiamata e il servizio finale o viceversa.\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"https://doc.traefik.io/traefik/assets/img/middleware/overview.png\",alt:\"middlwares\",title:\"Esempio middlewares Traefik\"}))),mdx(\"p\",null,\"Nella mia configurazione ho creato tre middlewares che trovo molto utili. Per crearli basta creare un file all'interno della cartella dynamic vista nel primo articolo dedicato a Traefik (\",mdx(\"a\",e({parentName:\"p\"},{href:\"/posts/2020-11-04-traefik-intro/\"}),\"lo trovate qui\"),\").\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"E' anche possibile crearli tramite label dei container, utile se \\xE8 specifico per un determinato servizio.\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\"},\"Redirect to https, abbastanza semplice da capire, effettua il redirect delle chiamate verso lo schema specificato. Nel mio caso tutte verso https.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-yaml\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-yaml\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"---\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"http\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"redirect-to-https\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"redirectScheme\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"scheme\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` https\n`)))),mdx(\"ol\",e({},{start:2}),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\"},\"Basic auth, utile per redendere un po' pi\\xF9 sicuro un endpoint aggiungendo un'autenticazione.\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"E' possibile specificare l'elenco di coppie username: password, la password deve essere criptata tramite MD5, SHA1, o BCrypt, per fare questo \\xE8 possibile utilizzare su sistemi Linux \",mdx(\"inlineCode\",{parentName:\"p\"},\"htpasswd\"),\". E' anche possibile specificare il path di un file contenente gli utenti, sempre nello stesso formato, tramite l'attributo \",mdx(\"inlineCode\",{parentName:\"p\"},\"usersFile \"),\"al posto di \",mdx(\"inlineCode\",{parentName:\"p\"},\"users\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-yaml\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-yaml\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"---\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"http\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"basic-auth\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"basicAuth\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"users\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"<username>:<password>\"'),`\n`))),mdx(\"li\",{parentName:\"ol\"},mdx(\"p\",{parentName:\"li\"},\"Compressione della risposta, credo sia uno dei pi\\xF9 importanti per limitare il consumo di banda. Comprime le risposte limitando appunto i dati scambiati.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-yaml\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-yaml\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"---\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"http\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"gzip-compress\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"compress\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)))),mdx(\"p\",null,\"Per utilizzare un middleware basta specificarlo nella configurazione della route.\"),mdx(\"pre\",e({},{className:\"language-yaml\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-yaml\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Se utilizzate un file come impostazione.\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"http\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"routers\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"nome-route\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\" gzip\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`compress\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\" redirect\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\"to\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`https\n        \n        \n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Se utilizzate le labels di un container come impostazione.\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.nome-route.middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" gzip\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\"compress@file\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" redirect\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\"to\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`https@file\n`)),mdx(\"p\",null,\"Spero di esservi stato utile e rimango sempre a disposizione per aiutarvi.\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"post":{"slug":"2020-11-12-traefik-middlewares","title":"Traefik - Middlewares","date":"2020-11-12T14:44:54.748Z","description":"Creare i meddlewares base per Traefik","image":null,"tags":["self-hosted","traefik","middlewares"],"content":"Buongiorno a tutti,  \noggi vedremo come creare i primi e più semplici middlewares per Traefik.  \nCosa è un middleware?   \nSemplificando molto è qualcosa che si frappone tra la chiamata e il servizio finale o viceversa.\n\n![middlwares](https://doc.traefik.io/traefik/assets/img/middleware/overview.png \"Esempio middlewares Traefik\")\n\nNella mia configurazione ho creato tre middlewares che trovo molto utili. Per crearli basta creare un file all'interno della cartella dynamic vista nel primo articolo dedicato a Traefik ([lo trovate qui](/posts/2020-11-04-traefik-intro/)).   \nE' anche possibile crearli tramite label dei container, utile se è specifico per un determinato servizio.\n\n1. Redirect to https, abbastanza semplice da capire, effettua il redirect delle chiamate verso lo schema specificato. Nel mio caso tutte verso https.\n\n   ```yaml\n   ---\n\n   http:\n     middlewares:\n       redirect-to-https:\n         redirectScheme:\n           scheme: https\n   ```\n\n\n2. Basic auth, utile per redendere un po' più sicuro un endpoint aggiungendo un'autenticazione.  \n   E' possibile specificare l'elenco di coppie username: password, la password deve essere criptata tramite MD5, SHA1, o BCrypt, per fare questo è possibile utilizzare su sistemi Linux `htpasswd`. E' anche possibile specificare il path di un file contenente gli utenti, sempre nello stesso formato, tramite l'attributo `usersFile `al posto di `users`.\n\n   ```yaml\n   ---\n\n   http:\n     middlewares:\n       basic-auth:\n         basicAuth:\n           users:\n             - \"<username>:<password>\"\n   ```\n3. Compressione della risposta, credo sia uno dei più importanti per limitare il consumo di banda. Comprime le risposte limitando appunto i dati scambiati.\n\n   ```yaml\n   ---\n\n   http:\n     middlewares:\n       gzip-compress:\n         compress: {}\n   ```\n\nPer utilizzare un middleware basta specificarlo nella configurazione della route.\n\n```yaml\n# Se utilizzate un file come impostazione.\nhttp:\n  routers:\n    nome-route:\n      middlewares:\n        - gzip-compress\n        - redirect-to-https\n        \n        \n# Se utilizzate le labels di un container come impostazione.\ntraefik.http.routers.nome-route.middlewares: gzip-compress@file, redirect-to-https@file\n```\n\nSpero di esservi stato utile e rimango sempre a disposizione per aiutarvi."},"_superjson":{"values":{"post.date":["Date"],"post.image":["undefined"]}}},"__N_SSG":true}