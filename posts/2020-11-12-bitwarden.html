<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try{var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem("theme");if(e){d.add(e)}else{d.add('dark');}}catch(t){}}();</script><title>Bitwarden - T-Dev</title><meta content="Tutorial per installare Bitwarden tramite docker dietro reverse proxy Traefik" name="description"/><meta property="og:url" content="https://simon020286.github.io/posts/2020-11-12-bitwarden"/><link rel="canonical" href="https://simon020286.github.io/posts/2020-11-12-bitwarden"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Bitwarden"/><meta property="og:description" content="Tutorial per installare Bitwarden tramite docker dietro reverse proxy Traefik"/><meta property="og:title" content="Bitwarden"/><meta property="og:image" content="https://nextjs-typescript-mdx-blog.vercel.appundefined"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@huntarosan"/><meta name="twitter:title" content="Bitwarden"/><meta name="twitter:description" content="Tutorial per installare Bitwarden tramite docker dietro reverse proxy Traefik"/><meta name="twitter:image" content="https://nextjs-typescript-mdx-blog.vercel.appundefined"/><meta property="article:published_time" content="Wed Dec 02 2020"/><meta name="next-head-count" content="18"/><link rel="preload" href="/_next/static/css/0c40cfb25666af2eba95.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0c40cfb25666af2eba95.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-613fd858cdb9cf2af3be.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-1f2c591c5d3bfcfc95e6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a14dd6af74b8559dafb5.js" defer=""></script><script src="/_next/static/chunks/838-292b52a783d0bfb7b58f.js" defer=""></script><script src="/_next/static/chunks/384-52a5c121222f81fe3d13.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-4401efa11930ab4a9e32.js" defer=""></script><script src="/_next/static/UEf1buEjhsBLzCkg5oqMS/_buildManifest.js" defer=""></script><script src="/_next/static/UEf1buEjhsBLzCkg5oqMS/_ssgManifest.js" defer=""></script><style id="__jsx-1084485634">html,body,body>div:first-child,div#__next,div#__next>div{height:100%;}</style></head><body class="bg-white dark:bg-black text-gray-900 dark:text-white"><div id="__next"><div class="flex flex-col min-h-screen"><header><div class="max-w-5xl px-8 mx-auto"><div class="flex items-center justify-between py-6"><nav><a class="text-gray-900 dark:text-white pr-6 py-4" href="/">Home</a><a class="text-gray-900 dark:text-white px-6 py-4" href="/tags">Tags</a></nav></div></div></header><main class="mb-0 flex-grow"><div class="max-w-5xl px-8 py-4 mx-auto"><article><h1 class="mb-3 text-gray-900 dark:text-white">Bitwarden</h1><p class="mb-10 text-sm text-gray-500 dark:text-gray-400">December 02, 2020</p><div class="prose dark:prose-dark"><p>Buongiorno a tutti, eccoci con un nuovo articolo.<br/>
<!-- -->Oggi vedremo come utilizzare un password manager il cui server gira interamente sul tuo host personale.<br/>
<!-- -->Iniziamo col dire che come server non utilizzeremo Bitwarden ufficiale, ma una versione compatibile Bitwarden_Rs,<br/>
<!-- -->scritto in Rust che implementa quasi tutte le API ufficiali. E&#x27; molto più leggero, completamente gratuito, e in più utilizza l&#x27;app e le estensioni per browser ufficiali.<br/>
<!-- -->Come detto nell&#x27;articolo dedicato a Traefik (<a href="/posts/2020-11-04-traefik-intro">link</a>) è possibile impostare l&#x27;utilizzo del reverse proxy tramite labels, come potete vedere nel <code>docker-compose.yml</code> seguente.</p><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#x27;3&#x27;</span>

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">traefik_network</span><span class="token punctuation">:</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> traefik_trproxy
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">bitwarden</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&#x27;bitwardenrs/server&#x27;</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> bitwarden
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">DOMAIN</span><span class="token punctuation">:</span> <span class="token string">&#x27;https://&lt;dominio&gt;&#x27;</span>
      <span class="token key atrule">LOG_FILE</span><span class="token punctuation">:</span> /shared/logs/bitwarden/bitwarden.log
      <span class="token key atrule">LOG_LEVEL</span><span class="token punctuation">:</span> warn
      <span class="token key atrule">ROCKET_LOG</span><span class="token punctuation">:</span> critical
      <span class="token key atrule">WEBSOCKET_ENABLED</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
      <span class="token key atrule">SIGNUPS_ALLOWED</span><span class="token punctuation">:</span> <span class="token string">&#x27;false&#x27;</span>
    <span class="token key atrule">labels</span><span class="token punctuation">:</span>
      <span class="token key atrule">traefik.enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.docker.network</span><span class="token punctuation">:</span> traefik_trproxy
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.browserXssFilter</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.contentTypeNosniff</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.customResponseHeaders.X-Robots-Tag</span><span class="token punctuation">:</span> noindex<span class="token punctuation">,</span>nofollow<span class="token punctuation">,</span>nosnippet<span class="token punctuation">,</span>noarchive<span class="token punctuation">,</span>notranslate<span class="token punctuation">,</span>noimageindex
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.forceSTSHeader</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.frameDeny</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.sslRedirect</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.sslHost</span><span class="token punctuation">:</span> &lt;dominio<span class="token punctuation">&gt;</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.stsIncludeSubdomains</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.stsPreload</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.middlewares.bitwarden-security.headers.stsSeconds</span><span class="token punctuation">:</span> <span class="token number">315360000</span>
      <span class="token key atrule">traefik.http.services.bitwarden.loadbalancer.server.scheme</span><span class="token punctuation">:</span> http
      <span class="token key atrule">traefik.http.services.bitwarden.loadbalancer.server.port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">traefik.http.services.bitwarden-ws.loadbalancer.server.port</span><span class="token punctuation">:</span> <span class="token number">3012</span>
      <span class="token key atrule">traefik.http.routers.bitwarden-http.service</span><span class="token punctuation">:</span> bitwarden
      <span class="token key atrule">traefik.http.routers.bitwarden-http.rule</span><span class="token punctuation">:</span> Host(`&lt;dominio<span class="token punctuation">&gt;</span>`)
      <span class="token key atrule">traefik.http.routers.bitwarden-http.entrypoints</span><span class="token punctuation">:</span> http
      <span class="token key atrule">traefik.http.routers.bitwarden-http.middlewares</span><span class="token punctuation">:</span> bitwarden<span class="token punctuation">-</span>security<span class="token punctuation">,</span> gzip<span class="token punctuation">-</span>compress@file<span class="token punctuation">,</span> redirect<span class="token punctuation">-</span>to<span class="token punctuation">-</span>https@file
      <span class="token key atrule">traefik.http.routers.bitwarden.service</span><span class="token punctuation">:</span> bitwarden
      <span class="token key atrule">traefik.http.routers.bitwarden.rule</span><span class="token punctuation">:</span> Host(`&lt;dominio<span class="token punctuation">&gt;</span>`)
      <span class="token key atrule">traefik.http.routers.bitwarden.entrypoints</span><span class="token punctuation">:</span> https
      <span class="token key atrule">traefik.http.routers.bitwarden.middlewares</span><span class="token punctuation">:</span> bitwarden<span class="token punctuation">-</span>security<span class="token punctuation">,</span> gzip<span class="token punctuation">-</span>compress@file
      <span class="token key atrule">traefik.http.routers.bitwarden.tls</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.routers.bitwarden.tls.certresolver</span><span class="token punctuation">:</span> le
      <span class="token key atrule">traefik.http.routers.bitwarden-ws.service</span><span class="token punctuation">:</span> bitwarden<span class="token punctuation">-</span>ws
      <span class="token key atrule">traefik.http.routers.bitwarden-ws.rule</span><span class="token punctuation">:</span> Host(`&lt;dominio<span class="token punctuation">&gt;</span>`) <span class="token important">&amp;&amp;</span> Path(`/notifications/hub`)
      <span class="token key atrule">traefik.http.routers.bitwarden-ws.entrypoints</span><span class="token punctuation">:</span> https
      <span class="token key atrule">traefik.http.routers.bitwarden-ws.middlewares</span><span class="token punctuation">:</span> bitwarden<span class="token punctuation">-</span>security
      <span class="token key atrule">traefik.http.routers.bitwarden-ws.tls</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">traefik.http.routers.bitwarden-ws.tls.certresolver</span><span class="token punctuation">:</span> le
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> traefik_network
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> &lt;dir<span class="token punctuation">&gt;</span>/data<span class="token punctuation">:</span>/data
      <span class="token punctuation">-</span> &lt;shared dir<span class="token punctuation">&gt;</span><span class="token punctuation">:</span>/shared
</code></pre><p>E&#x27; molto importante rispettare alcune regole.</p><ol><li>il nome della connessione <code>traefik_network</code> deve essere lo stesso definito per traefik</li><li><code>LOG_FILE: /shared/logs/bitwarden/bitwarden.log</code> il path <code>/shared</code> deve essere lo stesso mappato nel volume</li><li><code>SIGNUPS_ALLOWED: &quot;false&quot;</code> al primo avvio bisogna impostarlo a <code>true</code>, altrimenti non sarà possibile registrare nessun utente, io l&#x27;ho messo a <code>false</code> dopo aver creato il mio utente e quello di mia moglie, in modo che nessuno sconosciuto si possa registrare. Siete liberi di lasciarlo a <code>true</code>.</li><li>sostituire <code>&lt;dominio&gt;</code> con il vostro dominio</li></ol><p>Fatto questo è possibile lanciare il container semplicemente con il comando <code>docker-compose up -d</code>.<br/>
<!-- -->Avviato il container sarà possibile procedere alla registrazione del primo utente andato all&#x27;url specificato in <code>&lt;dominio&gt;</code>.</p><p>Buon divertimento con il vostro nuovo password manager.</p></div></article></div></main><footer class="py-8"><div class="max-w-5xl px-8 mx-auto">Built by T-Dev</div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"var l=Object.defineProperty,N=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var c=(a,n,t)=\u003en in a?l(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=\u003e{for(var t in n||(n={}))o.call(n,t)\u0026\u0026c(a,t,n[t]);if(p)for(var t of p(n))r.call(n,t)\u0026\u0026c(a,t,n[t]);return a},i=(a,n)=\u003eN(a,d(n));var m=(a,n)=\u003e{var t={};for(var s in a)o.call(a,s)\u0026\u0026n.indexOf(s)\u003c0\u0026\u0026(t[s]=a[s]);if(a!=null\u0026\u0026p)for(var s of p(a))n.indexOf(s)\u003c0\u0026\u0026r.call(a,s)\u0026\u0026(t[s]=a[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,i(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"Buongiorno a tutti, eccoci con un nuovo articolo.\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"Oggi vedremo come utilizzare un password manager il cui server gira interamente sul tuo host personale.\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"Iniziamo col dire che come server non utilizzeremo Bitwarden ufficiale, ma una versione compatibile Bitwarden_Rs,\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"scritto in Rust che implementa quasi tutte le API ufficiali. E' molto pi\\xF9 leggero, completamente gratuito, e in pi\\xF9 utilizza l'app e le estensioni per browser ufficiali.\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"Come detto nell'articolo dedicato a Traefik (\",mdx(\"a\",e({parentName:\"p\"},{href:\"/posts/2020-11-04-traefik-intro\"}),\"link\"),\") \\xE8 possibile impostare l'utilizzo del reverse proxy tramite labels, come potete vedere nel \",mdx(\"inlineCode\",{parentName:\"p\"},\"docker-compose.yml\"),\" seguente.\"),mdx(\"pre\",e({},{className:\"language-yaml\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-yaml\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"version\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'3'\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"networks\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik_network\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"external\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"name\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` traefik_trproxy\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"services\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"bitwarden\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"image\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'bitwardenrs/server'\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"container_name\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` bitwarden\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"environment\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"DOMAIN\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'https://\u003cdominio\u003e'\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"LOG_FILE\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` /shared/logs/bitwarden/bitwarden.log\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"LOG_LEVEL\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` warn\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"ROCKET_LOG\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` critical\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"WEBSOCKET_ENABLED\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'true'\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"SIGNUPS_ALLOWED\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'false'\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"labels\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.enable\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.docker.network\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` traefik_trproxy\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.browserXssFilter\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.contentTypeNosniff\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.customResponseHeaders.X-Robots-Tag\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" noindex\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\"nofollow\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\"nosnippet\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\"noarchive\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\"notranslate\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`noimageindex\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.forceSTSHeader\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.frameDeny\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.sslRedirect\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.sslHost\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \u003cdominio\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\u003e\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.stsIncludeSubdomains\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.stsPreload\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.middlewares.bitwarden-security.headers.stsSeconds\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"315360000\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.services.bitwarden.loadbalancer.server.scheme\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` http\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.services.bitwarden.loadbalancer.server.port\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"80\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.services.bitwarden-ws.loadbalancer.server.port\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"3012\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-http.service\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` bitwarden\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-http.rule\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" Host(`\u003cdominio\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\u003e\"),\"`)\\n      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-http.entrypoints\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` http\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-http.middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" bitwarden\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\"security\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" gzip\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\"compress@file\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" redirect\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\"to\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`https@file\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden.service\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` bitwarden\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden.rule\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" Host(`\u003cdominio\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\u003e\"),\"`)\\n      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden.entrypoints\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` https\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden.middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" bitwarden\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\"security\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" gzip\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`compress@file\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden.tls\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden.tls.certresolver\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` le\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-ws.service\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" bitwarden\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`ws\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-ws.rule\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" Host(`\u003cdominio\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\u003e\"),\"`) \",mdx(\"span\",e({parentName:\"code\"},{className:\"token important\"}),\"\u0026\u0026\"),\" Path(`/notifications/hub`)\\n      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-ws.entrypoints\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` https\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-ws.middlewares\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" bitwarden\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`security\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-ws.tls\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean important\"}),\"true\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"traefik.http.routers.bitwarden-ws.tls.certresolver\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` le\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"networks\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),` traefik_network\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"restart\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" unless\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),`stopped\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token key atrule\"}),\"volumes\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\" \u003cdir\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\u003e\"),\"/data\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`/data\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"-\"),\" \u003cshared dir\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\u003e\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`/shared\n`)),mdx(\"p\",null,\"E' molto importante rispettare alcune regole.\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"il nome della connessione \",mdx(\"inlineCode\",{parentName:\"li\"},\"traefik_network\"),\" deve essere lo stesso definito per traefik\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"inlineCode\",{parentName:\"li\"},\"LOG_FILE: /shared/logs/bitwarden/bitwarden.log\"),\" il path \",mdx(\"inlineCode\",{parentName:\"li\"},\"/shared\"),\" deve essere lo stesso mappato nel volume\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"inlineCode\",{parentName:\"li\"},'SIGNUPS_ALLOWED: \"false\"'),\" al primo avvio bisogna impostarlo a \",mdx(\"inlineCode\",{parentName:\"li\"},\"true\"),\", altrimenti non sar\\xE0 possibile registrare nessun utente, io l'ho messo a \",mdx(\"inlineCode\",{parentName:\"li\"},\"false\"),\" dopo aver creato il mio utente e quello di mia moglie, in modo che nessuno sconosciuto si possa registrare. Siete liberi di lasciarlo a \",mdx(\"inlineCode\",{parentName:\"li\"},\"true\"),\".\"),mdx(\"li\",{parentName:\"ol\"},\"sostituire \",mdx(\"inlineCode\",{parentName:\"li\"},\"\u003cdominio\u003e\"),\" con il vostro dominio\")),mdx(\"p\",null,\"Fatto questo \\xE8 possibile lanciare il container semplicemente con il comando \",mdx(\"inlineCode\",{parentName:\"p\"},\"docker-compose up -d\"),\".\",mdx(\"br\",{parentName:\"p\"}),`\n`,\"Avviato il container sar\\xE0 possibile procedere alla registrazione del primo utente andato all'url specificato in \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003cdominio\u003e\"),\".\"),mdx(\"p\",null,\"Buon divertimento con il vostro nuovo password manager.\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"post":{"slug":"2020-11-12-bitwarden","title":"Bitwarden","date":"2020-12-02T10:42:33.662Z","description":"Tutorial per installare Bitwarden tramite docker dietro reverse proxy Traefik","image":null,"tags":["self-hosted","passwordmanage","bitwarden","traefik"],"content":"\nBuongiorno a tutti, eccoci con un nuovo articolo.  \nOggi vedremo come utilizzare un password manager il cui server gira interamente sul tuo host personale.  \nIniziamo col dire che come server non utilizzeremo Bitwarden ufficiale, ma una versione compatibile Bitwarden_Rs,  \nscritto in Rust che implementa quasi tutte le API ufficiali. E' molto più leggero, completamente gratuito, e in più utilizza l'app e le estensioni per browser ufficiali.  \nCome detto nell'articolo dedicato a Traefik ([link](/posts/2020-11-04-traefik-intro)) è possibile impostare l'utilizzo del reverse proxy tramite labels, come potete vedere nel `docker-compose.yml` seguente.\n\n```yaml\nversion: '3'\n\nnetworks:\n  traefik_network:\n    external:\n      name: traefik_trproxy\nservices:\n  bitwarden:\n    image: 'bitwardenrs/server'\n    container_name: bitwarden\n    environment:\n      DOMAIN: 'https://\u003cdominio\u003e'\n      LOG_FILE: /shared/logs/bitwarden/bitwarden.log\n      LOG_LEVEL: warn\n      ROCKET_LOG: critical\n      WEBSOCKET_ENABLED: 'true'\n      SIGNUPS_ALLOWED: 'false'\n    labels:\n      traefik.enable: true\n      traefik.docker.network: traefik_trproxy\n      traefik.http.middlewares.bitwarden-security.headers.browserXssFilter: true\n      traefik.http.middlewares.bitwarden-security.headers.contentTypeNosniff: true\n      traefik.http.middlewares.bitwarden-security.headers.customResponseHeaders.X-Robots-Tag: noindex,nofollow,nosnippet,noarchive,notranslate,noimageindex\n      traefik.http.middlewares.bitwarden-security.headers.forceSTSHeader: true\n      traefik.http.middlewares.bitwarden-security.headers.frameDeny: true\n      traefik.http.middlewares.bitwarden-security.headers.sslRedirect: true\n      traefik.http.middlewares.bitwarden-security.headers.sslHost: \u003cdominio\u003e\n      traefik.http.middlewares.bitwarden-security.headers.stsIncludeSubdomains: true\n      traefik.http.middlewares.bitwarden-security.headers.stsPreload: true\n      traefik.http.middlewares.bitwarden-security.headers.stsSeconds: 315360000\n      traefik.http.services.bitwarden.loadbalancer.server.scheme: http\n      traefik.http.services.bitwarden.loadbalancer.server.port: 80\n      traefik.http.services.bitwarden-ws.loadbalancer.server.port: 3012\n      traefik.http.routers.bitwarden-http.service: bitwarden\n      traefik.http.routers.bitwarden-http.rule: Host(`\u003cdominio\u003e`)\n      traefik.http.routers.bitwarden-http.entrypoints: http\n      traefik.http.routers.bitwarden-http.middlewares: bitwarden-security, gzip-compress@file, redirect-to-https@file\n      traefik.http.routers.bitwarden.service: bitwarden\n      traefik.http.routers.bitwarden.rule: Host(`\u003cdominio\u003e`)\n      traefik.http.routers.bitwarden.entrypoints: https\n      traefik.http.routers.bitwarden.middlewares: bitwarden-security, gzip-compress@file\n      traefik.http.routers.bitwarden.tls: true\n      traefik.http.routers.bitwarden.tls.certresolver: le\n      traefik.http.routers.bitwarden-ws.service: bitwarden-ws\n      traefik.http.routers.bitwarden-ws.rule: Host(`\u003cdominio\u003e`) \u0026\u0026 Path(`/notifications/hub`)\n      traefik.http.routers.bitwarden-ws.entrypoints: https\n      traefik.http.routers.bitwarden-ws.middlewares: bitwarden-security\n      traefik.http.routers.bitwarden-ws.tls: true\n      traefik.http.routers.bitwarden-ws.tls.certresolver: le\n    networks:\n      - traefik_network\n    restart: unless-stopped\n    volumes:\n      - \u003cdir\u003e/data:/data\n      - \u003cshared dir\u003e:/shared\n```\n\nE' molto importante rispettare alcune regole.\n\n1. il nome della connessione `traefik_network` deve essere lo stesso definito per traefik\n2. `LOG_FILE: /shared/logs/bitwarden/bitwarden.log` il path `/shared` deve essere lo stesso mappato nel volume\n3. `SIGNUPS_ALLOWED: \"false\"` al primo avvio bisogna impostarlo a `true`, altrimenti non sarà possibile registrare nessun utente, io l'ho messo a `false` dopo aver creato il mio utente e quello di mia moglie, in modo che nessuno sconosciuto si possa registrare. Siete liberi di lasciarlo a `true`.\n4. sostituire `\u003cdominio\u003e` con il vostro dominio\n\nFatto questo è possibile lanciare il container semplicemente con il comando `docker-compose up -d`.  \nAvviato il container sarà possibile procedere alla registrazione del primo utente andato all'url specificato in `\u003cdominio\u003e`.\n\nBuon divertimento con il vostro nuovo password manager.\n"},"_superjson":{"values":{"post.date":["Date"],"post.image":["undefined"]}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2020-11-12-bitwarden"},"buildId":"UEf1buEjhsBLzCkg5oqMS","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>