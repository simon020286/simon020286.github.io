<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try{var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem("theme");if(e){d.add(e)}else{d.add('dark');}}catch(t){}}();</script><title>Traefik - Middlewares - T-Dev</title><meta content="Creare i meddlewares base per Traefik" name="description"/><meta property="og:url" content="https://simon020286.github.io/posts/2020-11-12-traefik-middlewares"/><link rel="canonical" href="https://simon020286.github.io/posts/2020-11-12-traefik-middlewares"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Traefik - Middlewares"/><meta property="og:description" content="Creare i meddlewares base per Traefik"/><meta property="og:title" content="Traefik - Middlewares"/><meta property="og:image" content="https://nextjs-typescript-mdx-blog.vercel.appnull"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@huntarosan"/><meta name="twitter:title" content="Traefik - Middlewares"/><meta name="twitter:description" content="Creare i meddlewares base per Traefik"/><meta name="twitter:image" content="https://nextjs-typescript-mdx-blog.vercel.appnull"/><meta property="article:published_time" content="2020-11-12"/><meta name="next-head-count" content="18"/><link rel="preload" href="/_next/static/css/e2908799117bc784.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e2908799117bc784.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-514908bffb652963.js" defer=""></script><script src="/_next/static/chunks/framework-0f8b31729833af61.js" defer=""></script><script src="/_next/static/chunks/main-208998328ec77b24.js" defer=""></script><script src="/_next/static/chunks/pages/_app-aaebc3a3da0532ea.js" defer=""></script><script src="/_next/static/chunks/944-bcdef466c1c513ab.js" defer=""></script><script src="/_next/static/chunks/755-4754c4666917880f.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-722f6b594a092490.js" defer=""></script><script src="/_next/static/b-KQ0lt8156ogt_kcfQIB/_buildManifest.js" defer=""></script><script src="/_next/static/b-KQ0lt8156ogt_kcfQIB/_ssgManifest.js" defer=""></script><script src="/_next/static/b-KQ0lt8156ogt_kcfQIB/_middlewareManifest.js" defer=""></script></head><body class="bg-white dark:bg-black text-gray-900 dark:text-white"><div id="__next"><div class="flex flex-col min-h-screen"><header><div class="max-w-5xl px-8 mx-auto"><div class="flex items-center justify-between py-6"><nav><a class="text-gray-900 dark:text-white pr-6 py-4" href="/">Home</a><a class="text-gray-900 dark:text-white px-6 py-4" href="/tags">Tags</a></nav></div></div></header><main class="mb-0 flex-grow"><div class="max-w-5xl px-8 py-4 mx-auto"><article><h1 class="mb-3 text-gray-900 dark:text-white">Traefik - Middlewares</h1><p class="mb-10 text-sm text-gray-500 dark:text-gray-400">November 12, 2020</p><div class="prose dark:prose-dark"><p>Buongiorno a tutti,<br/>
<!-- -->oggi vedremo come creare i primi e più semplici middlewares per Traefik.<br/>
<!-- -->Cosa è un middleware?<br/>
<!-- -->Semplificando molto è qualcosa che si frappone tra la chiamata e il servizio finale o viceversa.</p>
<p><img src="https://doc.traefik.io/traefik/assets/img/middleware/overview.png" alt="middlwares" title="Esempio middlewares Traefik"/></p>
<p>Nella mia configurazione ho creato tre middlewares che trovo molto utili. Per crearli basta creare un file all&#x27;interno della cartella dynamic vista nel primo articolo dedicato a Traefik (<a href="/posts/2020-11-04-traefik-intro/">lo trovate qui</a>).<br/>
<!-- -->E&#x27; anche possibile crearli tramite label dei container, utile se è specifico per un determinato servizio.</p>
<ol>
<li>
<p>Redirect to https, abbastanza semplice da capire, effettua il redirect delle chiamate verso lo schema specificato. Nel mio caso tutte verso https.</p>
<pre><code class="hljs language-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">http:</span>
  <span class="hljs-attr">middlewares:</span>
    <span class="hljs-attr">redirect-to-https:</span>
      <span class="hljs-attr">redirectScheme:</span>
        <span class="hljs-attr">scheme:</span> <span class="hljs-string">https</span>
</code></pre>
</li>
<li>
<p>Basic auth, utile per redendere un po&#x27; più sicuro un endpoint aggiungendo un&#x27;autenticazione.<br/>
<!-- -->E&#x27; possibile specificare l&#x27;elenco di coppie username: password, la password deve essere criptata tramite MD5, SHA1, o BCrypt, per fare questo è possibile utilizzare su sistemi Linux <code>htpasswd</code>. E&#x27; anche possibile specificare il path di un file contenente gli utenti, sempre nello stesso formato, tramite l&#x27;attributo <code>usersFile </code>al posto di <code>users</code>.</p>
<pre><code class="hljs language-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">http:</span>
  <span class="hljs-attr">middlewares:</span>
    <span class="hljs-attr">basic-auth:</span>
      <span class="hljs-attr">basicAuth:</span>
        <span class="hljs-attr">users:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;&lt;username&gt;:&lt;password&gt;&#x27;</span>
</code></pre>
</li>
<li>
<p>Compressione della risposta, credo sia uno dei più importanti per limitare il consumo di banda. Comprime le risposte limitando appunto i dati scambiati.</p>
<pre><code class="hljs language-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">http:</span>
  <span class="hljs-attr">middlewares:</span>
    <span class="hljs-attr">gzip-compress:</span>
      <span class="hljs-attr">compress:</span> {}
</code></pre>
</li>
</ol>
<p>Per utilizzare un middleware basta specificarlo nella configurazione della route.</p>
<pre><code class="hljs language-yaml"><span class="hljs-comment"># Se utilizzate un file come impostazione.</span>
<span class="hljs-attr">http:</span>
  <span class="hljs-attr">routers:</span>
    <span class="hljs-attr">nome-route:</span>
      <span class="hljs-attr">middlewares:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">gzip-compress</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">redirect-to-https</span>

<span class="hljs-comment"># Se utilizzate le labels di un container come impostazione.</span>
<span class="hljs-attr">traefik.http.routers.nome-route.middlewares:</span> <span class="hljs-string">gzip-compress@file,</span> <span class="hljs-string">redirect-to-https@file</span>
</code></pre>
<p>Spero di esservi stato utile e rimango sempre a disposizione per aiutarvi.</p></div></article></div></main><footer class="py-8"><div class="max-w-5xl px-8 mx-auto">Built by T-Dev</div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":"\nBuongiorno a tutti,  \noggi vedremo come creare i primi e più semplici middlewares per Traefik.  \nCosa è un middleware?  \nSemplificando molto è qualcosa che si frappone tra la chiamata e il servizio finale o viceversa.\n\n![middlwares](https://doc.traefik.io/traefik/assets/img/middleware/overview.png 'Esempio middlewares Traefik')\n\nNella mia configurazione ho creato tre middlewares che trovo molto utili. Per crearli basta creare un file all'interno della cartella dynamic vista nel primo articolo dedicato a Traefik ([lo trovate qui](/posts/2020-11-04-traefik-intro/)).  \nE' anche possibile crearli tramite label dei container, utile se è specifico per un determinato servizio.\n\n1. Redirect to https, abbastanza semplice da capire, effettua il redirect delle chiamate verso lo schema specificato. Nel mio caso tutte verso https.\n\n   ```yaml\n   ---\n   http:\n     middlewares:\n       redirect-to-https:\n         redirectScheme:\n           scheme: https\n   ```\n\n2. Basic auth, utile per redendere un po' più sicuro un endpoint aggiungendo un'autenticazione.  \n   E' possibile specificare l'elenco di coppie username: password, la password deve essere criptata tramite MD5, SHA1, o BCrypt, per fare questo è possibile utilizzare su sistemi Linux `htpasswd`. E' anche possibile specificare il path di un file contenente gli utenti, sempre nello stesso formato, tramite l'attributo `usersFile `al posto di `users`.\n\n   ```yaml\n   ---\n   http:\n     middlewares:\n       basic-auth:\n         basicAuth:\n           users:\n             - '\u003cusername\u003e:\u003cpassword\u003e'\n   ```\n\n3. Compressione della risposta, credo sia uno dei più importanti per limitare il consumo di banda. Comprime le risposte limitando appunto i dati scambiati.\n\n   ```yaml\n   ---\n   http:\n     middlewares:\n       gzip-compress:\n         compress: {}\n   ```\n\nPer utilizzare un middleware basta specificarlo nella configurazione della route.\n\n```yaml\n# Se utilizzate un file come impostazione.\nhttp:\n  routers:\n    nome-route:\n      middlewares:\n        - gzip-compress\n        - redirect-to-https\n\n# Se utilizzate le labels di un container come impostazione.\ntraefik.http.routers.nome-route.middlewares: gzip-compress@file, redirect-to-https@file\n```\n\nSpero di esservi stato utile e rimango sempre a disposizione per aiutarvi.\n","post":{"slug":"2020-11-12-traefik-middlewares","title":"Traefik - Middlewares","date":"2020-11-12","description":"Creare i meddlewares base per Traefik","image":null,"tags":["self-hosted","traefik","middlewares"],"content":"\nBuongiorno a tutti,  \noggi vedremo come creare i primi e più semplici middlewares per Traefik.  \nCosa è un middleware?  \nSemplificando molto è qualcosa che si frappone tra la chiamata e il servizio finale o viceversa.\n\n![middlwares](https://doc.traefik.io/traefik/assets/img/middleware/overview.png 'Esempio middlewares Traefik')\n\nNella mia configurazione ho creato tre middlewares che trovo molto utili. Per crearli basta creare un file all'interno della cartella dynamic vista nel primo articolo dedicato a Traefik ([lo trovate qui](/posts/2020-11-04-traefik-intro/)).  \nE' anche possibile crearli tramite label dei container, utile se è specifico per un determinato servizio.\n\n1. Redirect to https, abbastanza semplice da capire, effettua il redirect delle chiamate verso lo schema specificato. Nel mio caso tutte verso https.\n\n   ```yaml\n   ---\n   http:\n     middlewares:\n       redirect-to-https:\n         redirectScheme:\n           scheme: https\n   ```\n\n2. Basic auth, utile per redendere un po' più sicuro un endpoint aggiungendo un'autenticazione.  \n   E' possibile specificare l'elenco di coppie username: password, la password deve essere criptata tramite MD5, SHA1, o BCrypt, per fare questo è possibile utilizzare su sistemi Linux `htpasswd`. E' anche possibile specificare il path di un file contenente gli utenti, sempre nello stesso formato, tramite l'attributo `usersFile `al posto di `users`.\n\n   ```yaml\n   ---\n   http:\n     middlewares:\n       basic-auth:\n         basicAuth:\n           users:\n             - '\u003cusername\u003e:\u003cpassword\u003e'\n   ```\n\n3. Compressione della risposta, credo sia uno dei più importanti per limitare il consumo di banda. Comprime le risposte limitando appunto i dati scambiati.\n\n   ```yaml\n   ---\n   http:\n     middlewares:\n       gzip-compress:\n         compress: {}\n   ```\n\nPer utilizzare un middleware basta specificarlo nella configurazione della route.\n\n```yaml\n# Se utilizzate un file come impostazione.\nhttp:\n  routers:\n    nome-route:\n      middlewares:\n        - gzip-compress\n        - redirect-to-https\n\n# Se utilizzate le labels di un container come impostazione.\ntraefik.http.routers.nome-route.middlewares: gzip-compress@file, redirect-to-https@file\n```\n\nSpero di esservi stato utile e rimango sempre a disposizione per aiutarvi.\n"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"2020-11-12-traefik-middlewares"},"buildId":"b-KQ0lt8156ogt_kcfQIB","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>